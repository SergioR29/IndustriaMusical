SET SERVEROUTPUT ON;

DECLARE
    CURSOR categorias IS
        SELECT C.ID, C.ACADEMIA_, C.NOMBRE_PREMIACION, C.NOMBRE, C.PREMIO_EFECTIVO, C.GANADOR, C.FECHA_FIN_VOTACION, C.JURADOS, C.NOMINADAS FROM CATEGORIAS C;
    
    CURSOR premios IS
        SELECT P.NOMBRE, P.ACADEMIA_ FROM PREMIACIONES P;
        
    CATS CATEGORIAS_TIPO_ANIDADA := CATEGORIAS_TIPO_ANIDADA();
    CAT CATEGORIA;
BEGIN
    FOR P IN premios LOOP
        FOR C IN categorias LOOP
            IF C.NOMBRE_PREMIACION = P.NOMBRE AND C.ACADEMIA_ = P.ACADEMIA_ THEN
                CAT := CATEGORIA(C.ID, C.ACADEMIA_, C.NOMBRE_PREMIACION, C.NOMBRE, C.PREMIO_EFECTIVO, C.GANADOR, C.FECHA_FIN_VOTACION, C.JURADOS, C.NOMINADAS);
                
                CATS.EXTEND;
                CATS(CATS.LAST) := CAT;
            END IF;
        END LOOP;
        
        UPDATE PREMIACIONES PR SET PR.CATEGORIAS_TABLA = CATS WHERE PR.nombre = P.NOMBRE AND PR.academia_ = P.ACADEMIA_;
        COMMIT;
        
        CATS := CATEGORIAS_TIPO_ANIDADA();
    END LOOP;
END;